# WorldGuard 生电服配置指南

## 📋 配置概述

本配置文件经过专门优化，适用于生电技术服务器，平衡了主城保护与生电机器运行需求。

## ⚡ 主要改进功能

### 🔒 安全性增强
- ✅ 默认禁用管理员绕过功能，增强安全性
- ✅ 阻止游戏内 `/op` 命令使用
- ✅ 启用建造权限节点系统
- ✅ 启用文件日志记录，便于问题追踪

### 🏗️ 生电机器优化
- ✅ 允许TNT爆炸和方块破坏（生电机器核心需求）
- ✅ 允许打火石使用
- ✅ 允许插件生成生物（自动化农场需要）
- ✅ 禁用物品耐久度消耗（生电服常见需求）
- ✅ 增大可申请区域体积：30000 → 50000

### 🛡️ 建筑保护
- ✅ 禁止苦力怕、凋灵、末影龙等爆炸破坏
- ✅ 禁止末影人搬运方块
- ✅ 保护画作、物品展示框、盔甲架
- ✅ 防止液体流动破坏建筑
- ✅ 禁止树叶腐烂和藤蔓生长

### 🌱 环境优化
- ✅ 禁止生物踩踏农作物、海龟蛋、嗅探兽蛋
- ✅ 禁用雷击引燃和岩浆火焰传播
- ✅ 阻止地表史莱姆生成
- ✅ 禁止幽匿传感器蔓延

## 🚀 部署步骤

### 1. 备份现有配置
```bash
# 备份当前配置
cp plugins/WorldGuard/config.yml plugins/WorldGuard/config.yml.backup
```

### 2. 应用新配置
```bash
# 替换配置文件
cp config.yml plugins/WorldGuard/config.yml
```

### 3. 重载配置
```bash
# 在服务器控制台执行
/wg reload
```

## 🏰 主城区域设置

### 创建主城保护区域
```bash
# 1. 使用木斧选择区域范围
# 2. 创建主城区域
/rg define spawn
/rg expand vert spawn

# 3. 设置区域优先级
/rg priority spawn 100
```

### 主城区域标志配置
```bash
# 基础保护标志
/rg flag spawn build deny          # 禁止建造
/rg flag spawn pvp deny            # 禁止PVP
/rg flag spawn mob-spawning deny   # 禁止生物生成
/rg flag spawn creeper-explosion deny  # 禁止苦力怕爆炸
/rg flag spawn other-explosion deny    # 禁止其他爆炸
/rg flag spawn enderman-grief deny     # 禁止末影人搬方块

# 允许交互标志（便于使用生电设施）
/rg flag spawn use allow           # 允许使用方块
/rg flag spawn interact allow      # 允许交互
/rg flag spawn item-drop allow     # 允许掉落物品
/rg flag spawn item-pickup allow   # 允许拾取物品
/rg flag spawn chest-access allow  # 允许访问箱子
```

### 生电区域设置
```bash
# 为玩家创建生电区域
/rg define redstone_area

# 允许生电操作
/rg flag redstone_area tnt allow
/rg flag redstone_area lighter allow
/rg flag redstone_area build allow
```

## 📊 性能优化建议

### 服务器配置推荐
```yaml
# spigot.yml 建议设置
settings:
  save-user-cache-on-stop-only: true
world-settings:
  default:
    mob-spawn-range: 6
    entity-activation-range:
      animals: 16
      monsters: 24
      raiders: 48
```

### 定期维护
```bash
# 每周执行区域数据库清理
/wg migratedb mysql

# 检查配置完整性
/wg check
```

## 🔧 自定义配置

### 调整区域限制
如需修改玩家区域限制：
```yaml
regions:
  max-region-count-per-player:
    default: 12        # 普通玩家
    vip: 20           # VIP玩家
    admin: -1         # 管理员无限制
```

### 添加特殊权限组
```yaml
# 为生电玩家创建特殊权限
permissions:
  groups:
    redstone_engineer:
      permissions:
        - worldguard.region.unlimited
        - worldguard.build.bypass
```

## ⚠️ 注意事项

1. **TNT使用**: 全局允许TNT，请在主城区域单独禁用
2. **假玩家**: 已禁用假玩家建造覆盖，确保生电机器安全
3. **爆炸保护**: 仅在主城等重要区域设置爆炸保护标志
4. **性能考虑**: 大型生电机器可能需要额外的性能优化

## 🆘 故障排除

### 常见问题
1. **TNT不工作**: 检查区域是否设置了 `tnt deny` 标志
2. **无法建造**: 确认玩家有相应区域权限
3. **机器异常**: 检查是否有冲突的插件

### 日志位置
```
logs/worldguard/YYYY-MM-DD.log
```

---

**配置版本**: 生电服优化版 v1.0  
**更新时间**: $(date)  
**适用版本**: WorldGuard 7.x+, Minecraft 1.20+
